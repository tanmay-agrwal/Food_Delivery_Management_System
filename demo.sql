CREATE TABLE CUSTOMER (
    CID       INT PRIMARY KEY,
    Fname    VARCHAR(50),
    Lname    VARCHAR(50),
    DoB      DATE,
    Age      INT,
    Ph_no    VARCHAR(10),
    City     VARCHAR(50) NOT NULL,
    Pincode  INT NOT NULL
);

INSERT INTO CUSTOMER VALUES(10958,'Aarav','Patel','1984-05-22',39,'8492622636','Bangalore',560026);
INSERT INTO CUSTOMER VALUES(10398,'Anaya','Sharma','1996-09-13',27,'7853592408','Hyderabad',500038);
INSERT INTO CUSTOMER VALUES(10445,'Aryan','Reddy','1990-12-07',33,'7700284405','Bangalore',560026);
INSERT INTO CUSTOMER VALUES(10683,'Devika','Khan','1987-03-30',37,'7414166589','Bangalore',560026);
INSERT INTO CUSTOMER VALUES(10138,'Arjun','Singh','1982-07-18',41,'8845204301','Hyderabad',500078);
INSERT INTO CUSTOMER VALUES(10381,'Ishita','Choudhury','2003-10-05',20,'8097999429','Hyderabad',500003);
INSERT INTO CUSTOMER VALUES(10586,'Siddharth','Kumar','1999-02-09',25,'9848128297','Bangalore',560083);
INSERT INTO CUSTOMER VALUES(10344,'Kavya','Das','1986-11-25',37,'8259519317','Hyderabad',500078);
INSERT INTO CUSTOMER VALUES(10914,'Aditya','Chauhan','1981-06-14',42,'7136193536','Hyderabad',500038);
INSERT INTO CUSTOMER VALUES(10511,'Diya','Gupta','1992-08-01',31,'7039998252','Bangalore',560026);
INSERT INTO CUSTOMER VALUES(10196,'Virat','Fernandes','1988-04-12',36,'7641469276','Hyderabad',500038);
INSERT INTO CUSTOMER VALUES(10841,'Naina','Menon','2000-01-29',24,'8116895224','Bangalore',560083);
INSERT INTO CUSTOMER VALUES(10252,'Rohan','Desai','1983-09-05',40,'8956155086','Hyderabad',500038);
INSERT INTO CUSTOMER VALUES(10155,'Maya','Rao','1994-07-03',29,'8269937136','Bangalore',560026);
INSERT INTO CUSTOMER VALUES(10367,'Vikram','Joshi','1985-10-20',38,'9670406811','Bangalore',560083);
INSERT INTO CUSTOMER VALUES(10702,'Priya','Banerjee','2001-05-10',22,'8646136002','Hyderabad',500078);
INSERT INTO CUSTOMER VALUES(10465,'Krish','Malhotra','1991-08-27',32,'9851377738','Hyderabad',500038);
INSERT INTO CUSTOMER VALUES(10095,'Sanya','Bhatia','1997-11-02',26,'8997320362','Bangalore',560076);
INSERT INTO CUSTOMER VALUES(10496,'Rahul','Dutta','1989-03-18',35,'9648429826','Hyderabad',500003);
INSERT INTO CUSTOMER VALUES(10475,'Meera','Verma','1995-06-25',28,'7357901926','Hyderabad',500078);
INSERT INTO CUSTOMER VALUES(10950,'Raj','Seth','1980-12-14',43,'8129587311','Bangalore',560026);
INSERT INTO CUSTOMER VALUES(10214,'Pooja','Rao','2004-02-03',20,'8930785631','Hyderabad',500078);
INSERT INTO CUSTOMER VALUES(10378,'Aakash','Rao','1982-09-21',41,'7637687621','Bangalore',560026);
INSERT INTO CUSTOMER VALUES(10202,'Ayesha','Shah','1998-04-08',26,'7574831778','Hyderabad',500078);
INSERT INTO CUSTOMER VALUES(10277,'Sanjay','Chowdhury','1984-07-31',39,'8506174154','Bangalore',560076);
INSERT INTO CUSTOMER VALUES(10948,'Aisha','Mehra','1993-01-17',31,'7774963186','Bangalore',560083);
INSERT INTO CUSTOMER VALUES(10728,'Vivan','Khanna','2002-05-05',21,'8522290124','Hyderabad',500003);
INSERT INTO CUSTOMER VALUES(10680,'Zara','Sinha','1986-08-24',37,'7545156965','Hyderabad',500038);
INSERT INTO CUSTOMER VALUES(10195,'Advait','Dube','1999-11-13',24,'8727655049','Bangalore',560076);
INSERT INTO CUSTOMER VALUES(10709,'Anika','Nair','1981-03-02',43,'7668437082','Hyderabad',500078);
INSERT INTO CUSTOMER VALUES(10431,'Ishaan','Rawat','1996-06-19',27,'7688858929','Bangalore',560026);
INSERT INTO CUSTOMER VALUES(10340,'Riya','Patel','1988-10-10',35,'8777866103','Hyderabad',500038);
INSERT INTO CUSTOMER VALUES(10440,'Vihaan','Gupta','1992-02-26',32,'8696971296','Bangalore',560076);
INSERT INTO CUSTOMER VALUES(10892,'Neha','Rajput','1983-09-11',40,'7637024944','Hyderabad',500038);
INSERT INTO CUSTOMER VALUES(10928,'Arnav','Mishra','1985-12-30',38,'8629312661','Bangalore',560083);
INSERT INTO CUSTOMER VALUES(10402,'Esha','Singhania','2000-04-20',23,'7426713634','Hyderabad',500078);
INSERT INTO CUSTOMER VALUES(10326,'Yash','Iyer','1987-07-08',36,'9272156318','Bangalore',560076);
INSERT INTO CUSTOMER VALUES(10542,'Tanvi','Mukherjee','1995-01-25',29,'7886597504','Hyderabad',500078);
INSERT INTO CUSTOMER VALUES(10466,'Aadi','Shenoy','1982-05-14',41,'7251692805','Hyderabad',500078);
INSERT INTO CUSTOMER VALUES(10297,'Aarohi','Pandey','1990-08-03',33,'7796264730','Bangalore',560083);
INSERT INTO CUSTOMER VALUES(10954,'Armaan','Chakraborty','1997-11-29',26,'8520647352','Bangalore',560083);
INSERT INTO CUSTOMER VALUES(10218,'Sana','Sengupta','1984-03-07',40,'7160179511','Hyderabad',500003);
INSERT INTO CUSTOMER VALUES(10635,'Kabir','Ghosh','1989-06-26',34,'7232533137','Bangalore',560076);
INSERT INTO CUSTOMER VALUES(10205,'Ishika','Mehta','1993-10-13',30,'7157511390','Hyderabad',500078);
INSERT INTO CUSTOMER VALUES(10564,'Ayaan','Bajaj','2005-02-01',19,'8713247191','Hyderabad',500038);
INSERT INTO CUSTOMER VALUES(10106,'Saanvi','Rana','1981-09-15',42,'7929878209','Bangalore',560026);
INSERT INTO CUSTOMER VALUES(10494,'Reyansh','Agarwal','1991-12-11',32,'7777483754','Hyderabad',500003);
INSERT INTO CUSTOMER VALUES(10969,'Avni','Mallick','1986-04-01',38,'7030100574','Bangalore',560026);
INSERT INTO CUSTOMER VALUES(10961,'Shaan','Kulkarni','1998-07-21',25,'8957891450','Hyderabad',500003);
INSERT INTO CUSTOMER VALUES(10982,'Aarushi','Sharma','1994-01-09',30,'9158878566','Bangalore',560083);





CREATE TABLE SELLER(
    SID INT PRIMARY KEY,
    Name VARCHAR(50) NOT NULL,
    City VARCHAR(50) NOT NULL,
    Ph_no VARCHAR(10),
    Pin_Code INT NOT NULL,
    Rating DECIMAL(2, 1) CHECK (Rating >= 1 AND Rating <= 5)
);

INSERT INTO SELLER VALUES(5886,'Heritage','Bangalore','8358053387',560083,3.5);
INSERT INTO SELLER VALUES(5119,'Tasty_Palace','Bangalore','7948134881',560076,4.5);
INSERT INTO SELLER VALUES(5151,'Piccolo','Bangalore','8230113894',560026,5);
INSERT INTO SELLER VALUES(5618,'Spice_Express','Bangalore','8170970485',560083,4);
INSERT INTO SELLER VALUES(5982,'Tasty_Trails','Bangalore','8130977211',560076,3);
INSERT INTO SELLER VALUES(5328,'KFC','Bangalore','9621074702',560026,5);
INSERT INTO SELLER VALUES(5061,'Sweet_Delight','Bangalore','8535310299',560083,4.5);
INSERT INTO SELLER VALUES(5360,'Dessert_Delight','Bangalore','8686084276',560076,4);
INSERT INTO SELLER VALUES(5771,'Sugarplum_Bakery','Bangalore','8516406184',560026,5);
INSERT INTO SELLER VALUES(5837,'Bawarchi','Hyderabad','7540868289',500003,4.5);
INSERT INTO SELLER VALUES(5064,'Paradise','Hyderabad','7425387584',500038,4);
INSERT INTO SELLER VALUES(5784,'Tandoor','Hyderabad','9751648715',500078,4.5);
INSERT INTO SELLER VALUES(5913,'Barbeque_Nation','Hyderabad','7319132056',500003,4);
INSERT INTO SELLER VALUES(5841,'F3_Cafe','Hyderabad','8756084950',500038,4.5);
INSERT INTO SELLER VALUES(5420,'BitsnBytes','Hyderabad','9978073805',500078,4);
INSERT INTO SELLER VALUES(5304,'Karachi_Bakery','Hyderabad','9433037742',500003,5);
INSERT INTO SELLER VALUES(5248,'Lovely_Sweets','Hyderabad','8686094017',500038,3.5);
INSERT INTO SELLER VALUES(5036,'Agarwal_Sweets','Hyderabad','7853655184',500078,5);





CREATE TABLE DELIVERY_PARTNER (
    DID INT PRIMARY KEY,
    D_Name VARCHAR(25),
    Ph_no VARCHAR(10),
    City VARCHAR(20) NOT NULL
);

INSERT INTO DELIVERY_PARTNER VALUES(960,'Rahul_Sharma','8254951310','Bangalore');
INSERT INTO DELIVERY_PARTNER VALUES(942,'Vikram_Singh','7529197547','Bangalore');
INSERT INTO DELIVERY_PARTNER VALUES(945,'Mohan_Patel','9375694983','Bangalore');
INSERT INTO DELIVERY_PARTNER VALUES(971,'Rajesh_Kumar','7762833156','Bangalore');
INSERT INTO DELIVERY_PARTNER VALUES(867,'Deepak_Yadav','7622413541','Hyderabad');
INSERT INTO DELIVERY_PARTNER VALUES(803,'Ravi_Jain','8288777140','Hyderabad');
INSERT INTO DELIVERY_PARTNER VALUES(828,'Ajay_Gupta','7429599647','Hyderabad');
INSERT INTO DELIVERY_PARTNER VALUES(812,'Sanjay_Mishra','8766524887','Hyderabad');
INSERT INTO DELIVERY_PARTNER VALUES(941,'Arjun_Reddy','9045245546','Bangalore');
INSERT INTO DELIVERY_PARTNER VALUES(829,'Sai_Anirudh','9958589240','Hyderabad');
INSERT INTO DELIVERY_PARTNER VALUES(982,'Hriday_Gadia','8985487824','Bangalore');
INSERT INTO DELIVERY_PARTNER VALUES(854,'Prakash_Tiwari','9264652804','Hyderabad');
INSERT INTO DELIVERY_PARTNER VALUES(886,'Siddharth_Shah','7371121643','Hyderabad');
INSERT INTO DELIVERY_PARTNER VALUES(814,'Harsh_Kumble','7130791705','Hyderabad');
INSERT INTO DELIVERY_PARTNER VALUES(809,'Gaurav_Desai','8825265973','Hyderabad');
INSERT INTO DELIVERY_PARTNER VALUES(913,'Vivek_Soni','8684936258','Bangalore');
INSERT INTO DELIVERY_PARTNER VALUES(987,'Akash_Rathore','7760652373','Bangalore');
INSERT INTO DELIVERY_PARTNER VALUES(931,'Pradeep_Varma','7038602446','Bangalore');
INSERT INTO DELIVERY_PARTNER VALUES(967,'Sumit_Joshi','9236614363','Bangalore');
INSERT INTO DELIVERY_PARTNER VALUES(881,'Amar_Pandey','8877543270','Hyderabad');
INSERT INTO DELIVERY_PARTNER VALUES(861,'Rohit_Chauhan','7787940660','Hyderabad');
INSERT INTO DELIVERY_PARTNER VALUES(845,'Tarun_Gandhi','9240338184','Hyderabad');
INSERT INTO DELIVERY_PARTNER VALUES(976,'Shyam_Sharma','7644901519','Bangalore');





CREATE TABLE PRODUCT (
    SEL_ID INT NOT NULL,
    Item VARCHAR(20) NOT NULL, 
    Category VARCHAR(20) NOT NULL,
    Price INT NOT NULL,
    FOREIGN KEY (SEL_ID) REFERENCES SELLER(SID) ON DELETE CASCADE
);

INSERT INTO PRODUCT VALUES(5886,'Veg_Thali','Entree',180);
INSERT INTO PRODUCT VALUES(5886,'Non_Veg_Thali','Entree',250);
INSERT INTO PRODUCT VALUES(5886,'Chicken_Biryani','Entree',250);
INSERT INTO PRODUCT VALUES(5886,'Masala_Dosa','Entree',150);
INSERT INTO PRODUCT VALUES(5886,'Chole_Bhature','Entree',200);
INSERT INTO PRODUCT VALUES(5119,'Paneer_Thali','Entree',250);
INSERT INTO PRODUCT VALUES(5119,'Non_Veg_T1hali','Entree',300);
INSERT INTO PRODUCT VALUES(5119,'Masala_Dosa','Entree',120);
INSERT INTO PRODUCT VALUES(5119,'Rava_Idli','Appetizer',100);
INSERT INTO PRODUCT VALUES(5119,'Chken_Chettinad','Entree',280);
INSERT INTO PRODUCT VALUES(5151,'Rava_Idli','Appetizer',120);
INSERT INTO PRODUCT VALUES(5151,'Masala_Dosa','Appetizer',180);
INSERT INTO PRODUCT VALUES(5151,'Royal_Veg_Thali','Entree',250);
INSERT INTO PRODUCT VALUES(5151,'Paneer_Thali','Entree',220);
INSERT INTO PRODUCT VALUES(5151,'Chole_Bhature','Entree',180);
INSERT INTO PRODUCT VALUES(5618,'Bhelpuri','Appetizer',50);
INSERT INTO PRODUCT VALUES(5618,'Pav_Bhaji','Entree',80);
INSERT INTO PRODUCT VALUES(5618,'Chole_Bhature','Entree',150);
INSERT INTO PRODUCT VALUES(5618,'Kachori','Appetizer',70);
INSERT INTO PRODUCT VALUES(5618,'Bread_Pakoda','Appetizer',45);
INSERT INTO PRODUCT VALUES(5982,'Paneer_Pizza','Appetizer',350);
INSERT INTO PRODUCT VALUES(5982,'Sizzler','Entree',450);
INSERT INTO PRODUCT VALUES(5982,'Sandwich','Appetizer',150);
INSERT INTO PRODUCT VALUES(5982,'Maggi','Appetizer',75);
INSERT INTO PRODUCT VALUES(5982,'Rajma_Chawal','Entree',80);
INSERT INTO PRODUCT VALUES(5328,'Chicken_Nuggets','Appetizer',90);
INSERT INTO PRODUCT VALUES(5328,'Chicken_Wings','Appetizer',120);
INSERT INTO PRODUCT VALUES(5328,'Gizoa','Entree',180);
INSERT INTO PRODUCT VALUES(5328,'Chicken_Cheeza','Appetizer',145);
INSERT INTO PRODUCT VALUES(5328,'Chicken_Burger','Snacks',200);
INSERT INTO PRODUCT VALUES(5061,'Rasmalai','Sweets',450);
INSERT INTO PRODUCT VALUES(5061,'Rasgulla','Sweets',550);
INSERT INTO PRODUCT VALUES(5061,'Malai_Kulfi','Sweets',600);
INSERT INTO PRODUCT VALUES(5061,'Gulab_Jamun','Sweets',700);
INSERT INTO PRODUCT VALUES(5061,'Barfi','Sweets',500);
INSERT INTO PRODUCT VALUES(5360,'Trifle','Desserts',600);
INSERT INTO PRODUCT VALUES(5360,'Mousse_Cake','Desserts',700);
INSERT INTO PRODUCT VALUES(5360,'Milk_Cake','Desserts',600);
INSERT INTO PRODUCT VALUES(5360,'Brownies','Desserts',450);
INSERT INTO PRODUCT VALUES(5360,'Ice_Cream','Desserts',300);
INSERT INTO PRODUCT VALUES(5771,'Cheesecake','Desserts',1000);
INSERT INTO PRODUCT VALUES(5771,'Brownies','Desserts',550);
INSERT INTO PRODUCT VALUES(5771,'Croissant ','Desserts',300);
INSERT INTO PRODUCT VALUES(5771,'Pudding','Desserts',450);
INSERT INTO PRODUCT VALUES(5771,'Churros','Desserts',350);
INSERT INTO PRODUCT VALUES(5837,'Paneer_Biryani','Entree',250);
INSERT INTO PRODUCT VALUES(5837,'Chicken_Biryani','Entree',320);
INSERT INTO PRODUCT VALUES(5837,'Masala_Dosa','Entree',150);
INSERT INTO PRODUCT VALUES(5837,'Paneer_Thali','Entree',220);
INSERT INTO PRODUCT VALUES(5837,'Non_Veg_Thali','Entree',300);
INSERT INTO PRODUCT VALUES(5064,'Rava_Idli','Appetizer',130);
INSERT INTO PRODUCT VALUES(5064,'Masala_Dosa','Entree',180);
INSERT INTO PRODUCT VALUES(5064,'Royal_veg_Thali','Entree',270);
INSERT INTO PRODUCT VALUES(5064,'Paneer_Thali','Entree',250);
INSERT INTO PRODUCT VALUES(5064,'Chole_bhature','Entree',180);
INSERT INTO PRODUCT VALUES(5784,'Paneer_Biryani','Entree',180);
INSERT INTO PRODUCT VALUES(5784,'Chicken_Biryani','Entree',220);
INSERT INTO PRODUCT VALUES(5784,'Masala_Dosa','Entree',80);
INSERT INTO PRODUCT VALUES(5784,'Onion_Parantha','Entree',100);
INSERT INTO PRODUCT VALUES(5784,'Paneer_Parantha','Entree',150);
INSERT INTO PRODUCT VALUES(5913,'Ice_Cream','Desert',75);
INSERT INTO PRODUCT VALUES(5913,'Garlic_Bread','Appetizer',120);
INSERT INTO PRODUCT VALUES(5913,'Chillie_Paneer','Appetizer',150);
INSERT INTO PRODUCT VALUES(5913,'French Fries','Appetizer',100);
INSERT INTO PRODUCT VALUES(5913,'Veg_Bullets','Appetizer',60);
INSERT INTO PRODUCT VALUES(5841,'Pizza','Entree',280);
INSERT INTO PRODUCT VALUES(5841,'Burger','Appetizer',120);
INSERT INTO PRODUCT VALUES(5841,'Coffee','Drink',30);
INSERT INTO PRODUCT VALUES(5841,'Garlic_Bread','Appetizer',100);
INSERT INTO PRODUCT VALUES(5841,'Paasta','Entree',200);
INSERT INTO PRODUCT VALUES(5420,'Veg_Sub','Entree',160);
INSERT INTO PRODUCT VALUES(5420,'Chicken_Sub','Entree',180);
INSERT INTO PRODUCT VALUES(5420,'Hotdog','Appetizer',125);
INSERT INTO PRODUCT VALUES(5420,'Veg_Burger','Appetizer',130);
INSERT INTO PRODUCT VALUES(5420,'Samosa','Appetizer',60);
INSERT INTO PRODUCT VALUES(5304,'Cheesecake','Desserts ',110);
INSERT INTO PRODUCT VALUES(5304,'Croissant ','Desserts ',80);
INSERT INTO PRODUCT VALUES(5304,'Choco_Magnum','Desserts ',250);
INSERT INTO PRODUCT VALUES(5304,'Red_Velvet','Desserts ',220);
INSERT INTO PRODUCT VALUES(5304,'Black_Forest','Desserts ',300);
INSERT INTO PRODUCT VALUES(5248,'Kaju_Katli','Sweets',350);
INSERT INTO PRODUCT VALUES(5248,'Boondi_Laddoo','Sweets',400);
INSERT INTO PRODUCT VALUES(5248,'Jalebi','Sweets',50);
INSERT INTO PRODUCT VALUES(5248,'Rasmalai','Sweets',350);
INSERT INTO PRODUCT VALUES(5248,'Petha','Sweets',400);
INSERT INTO PRODUCT VALUES(5036,'Maysore_Pak','Sweets',300);
INSERT INTO PRODUCT VALUES(5036,'Rabdi','Sweets',220);
INSERT INTO PRODUCT VALUES(5036,'Jalebi','Sweets',80);
INSERT INTO PRODUCT VALUES(5036,'Rasgulla','Sweets',100);
INSERT INTO PRODUCT VALUES(5036,'Halwa','Sweets',300);





CREATE TABLE ORDERS(
    OID INT PRIMARY KEY,
    CID INT NOT NULL,
    Sel_ID INT,
    D_ID INT NOT NULL,
    Item VARCHAR(30),
    Status VARCHAR(30),
    Quantity INT,
    FOREIGN KEY (CID) REFERENCES CUSTOMER(CID), 
    FOREIGN KEY (Sel_ID) REFERENCES SELLER(SID),
    FOREIGN KEY (D_ID) REFERENCES DELIVERY_PARTNER (DID) 
);

INSERT INTO ORDERS VALUES(49542113,10326,5771,987,'Brownies','Out_For_Delivery',1);
INSERT INTO ORDERS VALUES(48272442,10095,5618,945,'Bhelpuri','Out_For_Delivery',1);
INSERT INTO ORDERS VALUES(40203826,10155,5618,982,'Pav_Bhaji','Delivered',2);
INSERT INTO ORDERS VALUES(47036712,10948,5771,942,'Churros','Out_For_Delivery',3);
INSERT INTO ORDERS VALUES(49047619,10728,5837,803,'Masala_Dosa','Out_For_Delivery',3);
INSERT INTO ORDERS VALUES(42094750,10402,5837,881,'Chicken_Biryani','Out_For_Delivery',3);
INSERT INTO ORDERS VALUES(43125774,10841,5151,982,'Royal_Veg_Thali','In_Process',3);
INSERT INTO ORDERS VALUES(49201687,10205,5841,809,'Garlic_Bread','Delivered',2);
INSERT INTO ORDERS VALUES(45538389,10431,5886,960,'Masala_Dosa','Out_For_Delivery',2);
INSERT INTO ORDERS VALUES(41234217,10465,5420,829,'Hotdog','Delivered',1);
INSERT INTO ORDERS VALUES(41327473,10466,5420,861,'Veg_Sub','Delivered',1);
INSERT INTO ORDERS VALUES(47752001,10892,5064,814,'Rava_Idli','Delivered',1);
INSERT INTO ORDERS VALUES(45233748,10496,5064,829,'Chole_bhature','In_Process',1);
INSERT INTO ORDERS VALUES(42070190,10841,5618,941,'Pav_Bhaji','Out_For_Delivery',3);
INSERT INTO ORDERS VALUES(47525717,10465,5784,881,'Paneer_Biryani','Delivered',3);
INSERT INTO ORDERS VALUES(49388862,10466,5784,854,'Paneer_Biryani','In_Process',1);
INSERT INTO ORDERS VALUES(42462386,10155,5982,976,'Paneer_Pizza','In_Process',2);
INSERT INTO ORDERS VALUES(47028899,10511,5886,976,'Chole_Bhature','Out_For_Delivery',3);
INSERT INTO ORDERS VALUES(41312178,10586,5618,945,'Bhelpuri','Delivered',3);
INSERT INTO ORDERS VALUES(45376907,10095,5360,945,'Ice_Cream','Out_For_Delivery',2);
INSERT INTO ORDERS VALUES(40965331,10095,5618,976,'Kachori','In_Process',3);
INSERT INTO ORDERS VALUES(48879204,10475,5913,803,'Veg_Bullets','In_Process',3);
INSERT INTO ORDERS VALUES(44195694,10564,5248,845,'Boondi_Laddoo','Out_For_Delivery',1);
INSERT INTO ORDERS VALUES(41137387,10841,5982,982,'Sandwich','In_Process',3);
INSERT INTO ORDERS VALUES(46607086,10969,5119,945,'Rava_Idli','Delivered',2);
INSERT INTO ORDERS VALUES(47793093,10155,5886,976,'Chicken_Biryani','In_Process',2);
INSERT INTO ORDERS VALUES(42702057,10683,5618,913,'Pav_Bhaji','In_Process',2);
INSERT INTO ORDERS VALUES(49050590,10465,5248,809,'Kaju_Katli','Delivered',1);
INSERT INTO ORDERS VALUES(42706179,10402,5304,861,'Choco_Magnum','Out_For_Delivery',2);
INSERT INTO ORDERS VALUES(49132656,10202,5784,854,'Paneer_Parantha','Delivered',3);
INSERT INTO ORDERS VALUES(47544288,10155,5982,987,'Sandwich','Out_For_Delivery',3);
INSERT INTO ORDERS VALUES(49113803,10106,5328,987,'Chicken_Nuggets','Out_For_Delivery',3);
INSERT INTO ORDERS VALUES(40378002,10138,5420,812,'Chicken_Sub','Delivered',1);
INSERT INTO ORDERS VALUES(48997545,10542,5837,886,'Paneer_Thali','Delivered',3);
INSERT INTO ORDERS VALUES(44464291,10398,5248,861,'Jalebi','In_Process',2);
INSERT INTO ORDERS VALUES(43829628,10202,5784,881,'Chicken_Biryani','Out_For_Delivery',3);
INSERT INTO ORDERS VALUES(42776974,10205,5064,809,'Rava_Idli','In_Process',2);
INSERT INTO ORDERS VALUES(41451663,10680,5784,854,'Paneer_Biryani','Delivered',3);
INSERT INTO ORDERS VALUES(40247178,10948,5618,942,'Chole_Bhature','In_Process',3);
INSERT INTO ORDERS VALUES(48240493,10586,5982,967,'Rajma_Chawal','Delivered',3);
INSERT INTO ORDERS VALUES(43931675,10277,5771,931,'Pudding','Out_For_Delivery',2);
INSERT INTO ORDERS VALUES(46045129,10340,5841,828,'Garlic_Bread','In_Process',1);
INSERT INTO ORDERS VALUES(45622413,10969,5982,960,'Paneer_Pizza','In_Process',1);
INSERT INTO ORDERS VALUES(43378688,10378,5151,941,'Paneer_Thali','In_Process',1);
INSERT INTO ORDERS VALUES(49985777,10635,5771,976,'Churros','In_Process',1);
INSERT INTO ORDERS VALUES(46757295,10398,5064,881,'Chole_bhature','Delivered',2);
INSERT INTO ORDERS VALUES(45291374,10367,5771,931,'Pudding','Out_For_Delivery',3);
INSERT INTO ORDERS VALUES(41567317,10344,5248,809,'Kaju_Katli','Out_For_Delivery',2);
INSERT INTO ORDERS VALUES(43089200,10969,5886,945,'Non_Veg_Thali','In_Process',2);
INSERT INTO ORDERS VALUES(43808894,10196,5304,828,'Red_Velvet','Out_For_Delivery',2);
INSERT INTO ORDERS VALUES(44158748,10475,5036,829,'Maysore_Pak','Delivered',2);
INSERT INTO ORDERS VALUES(44986017,10586,5771,945,'Brownies','In_Process',1);
INSERT INTO ORDERS VALUES(45928088,10402,5837,845,'Paneer_Biryani','In_Process',2);
INSERT INTO ORDERS VALUES(47926118,10948,5151,971,'Royal_Veg_Thali','In_Process',1);
INSERT INTO ORDERS VALUES(47995639,10954,5982,942,'Maggi','Out_For_Delivery',1);
INSERT INTO ORDERS VALUES(44706360,10218,5841,854,'Paasta','Delivered',3);
INSERT INTO ORDERS VALUES(47938835,10683,5886,941,'Chole_Bhature','Delivered',3);
INSERT INTO ORDERS VALUES(42586744,10277,5360,976,'Trifle','Out_For_Delivery',1);
INSERT INTO ORDERS VALUES(46225089,10214,5837,814,'Masala_Dosa','Out_For_Delivery',1);
INSERT INTO ORDERS VALUES(46005337,10095,5982,982,'Sizzler','Delivered',3);
INSERT INTO ORDERS VALUES(42620517,10680,5036,814,'Rabdi','Out_For_Delivery',3);
INSERT INTO ORDERS VALUES(43538141,10155,5982,987,'Sandwich','Delivered',2);
INSERT INTO ORDERS VALUES(44296175,10402,5036,828,'Maysore_Pak','Delivered',3);
INSERT INTO ORDERS VALUES(47181353,10106,5328,976,'Chicken_Cheeza','In_Process',1);
INSERT INTO ORDERS VALUES(49041757,10466,5064,809,'Royal_veg_Thali','Delivered',1);
INSERT INTO ORDERS VALUES(46449297,10928,5151,982,'Chole_Bhature','Out_For_Delivery',3);
INSERT INTO ORDERS VALUES(43200657,10367,5119,987,'Rava_Idli','In_Process',3);
INSERT INTO ORDERS VALUES(43325683,10564,5784,809,'Chicken_Biryani','In_Process',3);
INSERT INTO ORDERS VALUES(49632146,10466,5913,886,'Ice_Cream','Out_For_Delivery',3);
INSERT INTO ORDERS VALUES(42943739,10475,5064,845,'Rava_Idli','Out_For_Delivery',1);
INSERT INTO ORDERS VALUES(44086628,10445,5328,982,'Chicken_Nuggets','In_Process',1);
INSERT INTO ORDERS VALUES(43543328,10218,5841,886,'Paasta','In_Process',2);
INSERT INTO ORDERS VALUES(40655038,10496,5837,881,'Paneer_Thali','Out_For_Delivery',3);
INSERT INTO ORDERS VALUES(42457506,10218,5248,854,'Rasmalai','Delivered',1);
INSERT INTO ORDERS VALUES(46636417,10277,5618,971,'Chole_Bhature','In_Process',1);
INSERT INTO ORDERS VALUES(49970766,10680,5304,809,'Red_Velvet','In_Process',1);
INSERT INTO ORDERS VALUES(41377626,10914,5064,803,'Rava_Idli','Out_For_Delivery',1);
INSERT INTO ORDERS VALUES(42376100,10277,5151,976,'Chole_Bhature','Delivered',1);
INSERT INTO ORDERS VALUES(40901479,10431,5328,987,'Chicken_Wings','Delivered',1);
INSERT INTO ORDERS VALUES(49604071,10475,5420,854,'Veg_Burger','Delivered',1);
INSERT INTO ORDERS VALUES(42885885,10841,5119,913,'Masala_Dosa','Delivered',2);
INSERT INTO ORDERS VALUES(41726581,10948,5982,960,'Rajma_Chawal','Delivered',1);
INSERT INTO ORDERS VALUES(43624808,10961,5248,814,'Petha','Delivered',1);
INSERT INTO ORDERS VALUES(45429411,10106,5151,913,'Chole_Bhature','Out_For_Delivery',2);
INSERT INTO ORDERS VALUES(47736085,10680,5248,845,'Petha','Delivered',2);
INSERT INTO ORDERS VALUES(44335775,10277,5119,945,'Rava_Idli','Out_For_Delivery',1);
INSERT INTO ORDERS VALUES(41731878,10496,5913,881,'Garlic_Bread','Out_For_Delivery',3);
INSERT INTO ORDERS VALUES(41638940,10466,5841,886,'Coffee','Delivered',1);
INSERT INTO ORDERS VALUES(47191227,10205,5784,809,'Masala_Dosa','In_Process',3);
INSERT INTO ORDERS VALUES(45812799,10218,5837,854,'Chicken_Biryani','Delivered',1);
INSERT INTO ORDERS VALUES(47633949,10542,5036,814,'Jalebi','In_Process',3);
INSERT INTO ORDERS VALUES(48818634,10496,5064,854,'Chole_bhature','Out_For_Delivery',3);
INSERT INTO ORDERS VALUES(43659902,10381,5784,854,'Chicken_Biryani','In_Process',2);
INSERT INTO ORDERS VALUES(44973882,10381,5837,812,'Paneer_Biryani','Delivered',3);
INSERT INTO ORDERS VALUES(43262992,10496,5420,803,'Chicken_Sub','Delivered',1);
INSERT INTO ORDERS VALUES(48910597,10494,5304,845,'Red_Velvet','Delivered',1);
INSERT INTO ORDERS VALUES(42136694,10277,5618,982,'Chole_Bhature','Out_For_Delivery',1);
INSERT INTO ORDERS VALUES(44399744,10928,5886,976,'Veg_Thali','In_Process',2);
INSERT INTO ORDERS VALUES(42345389,10914,5036,809,'Halwa','Out_For_Delivery',2);
INSERT INTO ORDERS VALUES(46480931,10914,5837,845,'Masala_Dosa','Delivered',3);





CREATE TABLE PAYMENT (
    ONO INT PRIMARY KEY,
    Txn_no VARCHAR(20),
    Mode  VARCHAR(50),
   
 FOREIGN KEY (ONO) REFERENCES ORDERS(OID)
);

INSERT INTO PAYMENT VALUES(49542113,NULL,'Cash_On_Delivery');
INSERT INTO PAYMENT VALUES(48272442,NULL,'Cash_On_Delivery');
INSERT INTO PAYMENT VALUES(40203826,'133512343522','Net_Banking');
INSERT INTO PAYMENT VALUES(47036712,'446730385707','Net_Banking');
INSERT INTO PAYMENT VALUES(49047619,'546715268185','Net_Banking');
INSERT INTO PAYMENT VALUES(42094750,'751544015335','Net_Banking');
INSERT INTO PAYMENT VALUES(43125774,'945335987359','Net_Banking');
INSERT INTO PAYMENT VALUES(49201687,NULL,'Cash_On_Delivery');
INSERT INTO PAYMENT VALUES(45538389,'714915706251','Net_Banking');
INSERT INTO PAYMENT VALUES(41234217,NULL,'Cash_On_Delivery');
INSERT INTO PAYMENT VALUES(41327473,NULL,'Cash_On_Delivery');
INSERT INTO PAYMENT VALUES(47752001,NULL,'Cash_On_Delivery');
INSERT INTO PAYMENT VALUES(45233748,'305921156403','Net_Banking');
INSERT INTO PAYMENT VALUES(42070190,'428380503239','Net_Banking');
INSERT INTO PAYMENT VALUES(47525717,'654645661893','Net_Banking');
INSERT INTO PAYMENT VALUES(49388862,NULL,'Cash_On_Delivery');
INSERT INTO PAYMENT VALUES(42462386,NULL,'Cash_On_Delivery');
INSERT INTO PAYMENT VALUES(47028899,NULL,'Cash_On_Delivery');
INSERT INTO PAYMENT VALUES(41312178,NULL,'Cash_On_Delivery');
INSERT INTO PAYMENT VALUES(45376907,NULL,'Cash_On_Delivery');
INSERT INTO PAYMENT VALUES(40965331,NULL,'Cash_On_Delivery');
INSERT INTO PAYMENT VALUES(48879204,NULL,'Cash_On_Delivery');
INSERT INTO PAYMENT VALUES(44195694,NULL,'Cash_On_Delivery');
INSERT INTO PAYMENT VALUES(41137387,NULL,'Cash_On_Delivery');
INSERT INTO PAYMENT VALUES(46607086,'272569713722','Net_Banking');
INSERT INTO PAYMENT VALUES(47793093,NULL,'Cash_On_Delivery');
INSERT INTO PAYMENT VALUES(42702057,'552029631840','Net_Banking');
INSERT INTO PAYMENT VALUES(49050590,NULL,'Cash_On_Delivery');
INSERT INTO PAYMENT VALUES(42706179,NULL,'Cash_On_Delivery');
INSERT INTO PAYMENT VALUES(49132656,'791174900247','Net_Banking');
INSERT INTO PAYMENT VALUES(47544288,NULL,'Cash_On_Delivery');
INSERT INTO PAYMENT VALUES(49113803,'621761177439','Net_Banking');
INSERT INTO PAYMENT VALUES(40378002,'970772084310','Net_Banking');
INSERT INTO PAYMENT VALUES(48997545,NULL,'Cash_On_Delivery');
INSERT INTO PAYMENT VALUES(44464291,NULL,'Cash_On_Delivery');
INSERT INTO PAYMENT VALUES(43829628,'887637234052','Net_Banking');
INSERT INTO PAYMENT VALUES(42776974,'711801231047','Net_Banking');
INSERT INTO PAYMENT VALUES(41451663,NULL,'Cash_On_Delivery');
INSERT INTO PAYMENT VALUES(40247178,'355702587307','Net_Banking');
INSERT INTO PAYMENT VALUES(48240493,'337885460047','Net_Banking');
INSERT INTO PAYMENT VALUES(43931675,'204544542770','Net_Banking');
INSERT INTO PAYMENT VALUES(46045129,NULL,'Cash_On_Delivery');
INSERT INTO PAYMENT VALUES(45622413,NULL,'Cash_On_Delivery');
INSERT INTO PAYMENT VALUES(43378688,'231853588233','Net_Banking');
INSERT INTO PAYMENT VALUES(49985777,NULL,'Cash_On_Delivery');
INSERT INTO PAYMENT VALUES(46757295,NULL,'Cash_On_Delivery');
INSERT INTO PAYMENT VALUES(45291374,'450395202926','Net_Banking');
INSERT INTO PAYMENT VALUES(41567317,'303410700588','Net_Banking');
INSERT INTO PAYMENT VALUES(43089200,'484373482176','Net_Banking');
INSERT INTO PAYMENT VALUES(43808894,NULL,'Cash_On_Delivery');
INSERT INTO PAYMENT VALUES(44158748,'713682993598','Net_Banking');
INSERT INTO PAYMENT VALUES(44986017,'303497760798','Net_Banking');
INSERT INTO PAYMENT VALUES(45928088,NULL,'Cash_On_Delivery');
INSERT INTO PAYMENT VALUES(47926118,'964254877890','Net_Banking');
INSERT INTO PAYMENT VALUES(47995639,'258367272467','Net_Banking');
INSERT INTO PAYMENT VALUES(44706360,NULL,'Cash_On_Delivery');
INSERT INTO PAYMENT VALUES(47938835,'821743595016','Net_Banking');
INSERT INTO PAYMENT VALUES(42586744,NULL,'Cash_On_Delivery');
INSERT INTO PAYMENT VALUES(46225089,'608344841794','Net_Banking');
INSERT INTO PAYMENT VALUES(46005337,NULL,'Cash_On_Delivery');
INSERT INTO PAYMENT VALUES(42620517,NULL,'Cash_On_Delivery');
INSERT INTO PAYMENT VALUES(43538141,'794004078995','Net_Banking');
INSERT INTO PAYMENT VALUES(44296175,'926655727006','Net_Banking');
INSERT INTO PAYMENT VALUES(47181353,'848240753725','Net_Banking');
INSERT INTO PAYMENT VALUES(49041757,NULL,'Cash_On_Delivery');
INSERT INTO PAYMENT VALUES(46449297,NULL,'Cash_On_Delivery');
INSERT INTO PAYMENT VALUES(43200657,NULL,'Cash_On_Delivery');
INSERT INTO PAYMENT VALUES(43325683,NULL,'Cash_On_Delivery');
INSERT INTO PAYMENT VALUES(49632146,NULL,'Cash_On_Delivery');
INSERT INTO PAYMENT VALUES(42943739,NULL,'Cash_On_Delivery');
INSERT INTO PAYMENT VALUES(44086628,'118052509900','Net_Banking');
INSERT INTO PAYMENT VALUES(43543328,NULL,'Cash_On_Delivery');
INSERT INTO PAYMENT VALUES(40655038,'924334468256','Net_Banking');
INSERT INTO PAYMENT VALUES(42457506,'135547837574','Net_Banking');
INSERT INTO PAYMENT VALUES(46636417,NULL,'Cash_On_Delivery');
INSERT INTO PAYMENT VALUES(49970766,'736972851192','Net_Banking');
INSERT INTO PAYMENT VALUES(41377626,'132415019692','Net_Banking');
INSERT INTO PAYMENT VALUES(42376100,NULL,'Cash_On_Delivery');
INSERT INTO PAYMENT VALUES(40901479,NULL,'Cash_On_Delivery');
INSERT INTO PAYMENT VALUES(49604071,'826689131192','Net_Banking');
INSERT INTO PAYMENT VALUES(42885885,'972627661141','Net_Banking');
INSERT INTO PAYMENT VALUES(41726581,NULL,'Cash_On_Delivery');
INSERT INTO PAYMENT VALUES(43624808,NULL,'Cash_On_Delivery');
INSERT INTO PAYMENT VALUES(45429411,NULL,'Cash_On_Delivery');
INSERT INTO PAYMENT VALUES(47736085,NULL,'Cash_On_Delivery');
INSERT INTO PAYMENT VALUES(44335775,'667097427687','Net_Banking');
INSERT INTO PAYMENT VALUES(41731878,NULL,'Cash_On_Delivery');
INSERT INTO PAYMENT VALUES(41638940,'575035969012','Net_Banking');
INSERT INTO PAYMENT VALUES(47191227,NULL,'Cash_On_Delivery');
INSERT INTO PAYMENT VALUES(45812799,NULL,'Cash_On_Delivery');
INSERT INTO PAYMENT VALUES(47633949,NULL,'Cash_On_Delivery');
INSERT INTO PAYMENT VALUES(48818634,NULL,'Cash_On_Delivery');
INSERT INTO PAYMENT VALUES(43659902,'557637603474','Net_Banking');
INSERT INTO PAYMENT VALUES(44973882,NULL,'Cash_On_Delivery');
INSERT INTO PAYMENT VALUES(43262992,NULL,'Cash_On_Delivery');
INSERT INTO PAYMENT VALUES(48910597,NULL,'Cash_On_Delivery');
INSERT INTO PAYMENT VALUES(42136694,'469940603971','Net_Banking');
INSERT INTO PAYMENT VALUES(44399744,'321499520411','Net_Banking');
INSERT INTO PAYMENT VALUES(42345389,'194697154879','Net_Banking');
INSERT INTO PAYMENT VALUES(46480931,NULL,'Cash_On_Delivery');









--Procedure 0:

DELIMITER $$

CREATE PROCEDURE RegisterCustomer(
    IN _Fname VARCHAR(50),
    IN _Lname VARCHAR(50),
    IN _DoB DATE,
    IN _Ph_no VARCHAR(10),
    IN _City VARCHAR(50),
    IN _Pincode INT
)
BEGIN
    DECLARE _Age INT;
    DECLARE _CID INT;
  
    SET _CID = FLOOR(11000 + (RAND() * 1000));
    
    SET _Age = TIMESTAMPDIFF(YEAR, _DoB, '2024-04-21');

    INSERT INTO CUSTOMER (CID, Fname, Lname, DoB, Age, Ph_no, City, Pincode)
    VALUES (_CID, _Fname, _Lname, _DoB, _Age, _Ph_no, _City, _Pincode);
END$$

DELIMITER ;





--Procedure 1:

DELIMITER $$

CREATE PROCEDURE OrderDetails(
    IN p_ONO INT
)
BEGIN
    SELECT 
        C.Fname AS Customer_Name,
        C.City AS City,
        S.Name AS Seller,
        O.Item AS Item,
        O.Quantity * PR.Price AS Amount,
        P.Mode AS Payment_Mode,
        D.D_Name AS Delivery_Partner,
        D.Ph_no AS Delivery_Ph_no,
        O.Status AS Order_Status
        FROM PAYMENT P
    JOIN ORDERS O ON P.ONO = O.OID
    JOIN CUSTOMER C ON O.CID = C.CID
    JOIN SELLER S ON O.Sel_ID = S.SID
    JOIN DELIVERY_PARTNER D ON O.D_ID = D.DID
    JOIN PRODUCT PR ON PR.SEL_ID = O.Sel_ID AND PR.Item = O.Item
    WHERE P.ONO = p_ONO;
END$$

DELIMITER ;


       


--Procedure 2:        

DELIMITER $$

CREATE PROCEDURE NewOrder(
    IN _CID INT,
    IN _Sel_ID INT,
    IN _Item VARCHAR(30),
    IN _Quantity INT
)
BEGIN
    DECLARE _customerCity VARCHAR(50);
    DECLARE _sellerCity VARCHAR(50);
    DECLARE _itemExists BOOLEAN;
    DECLARE _randomOID BIGINT;
    DECLARE _selectedDID INT;
    DECLARE _Status VARCHAR(30) DEFAULT 'In_Process';

    SET _randomOID = FLOOR(50000000 + (RAND() * 10000000));

    SELECT City INTO _sellerCity FROM SELLER WHERE SID = _Sel_ID;
    SELECT City INTO _customerCity FROM CUSTOMER WHERE CID = _CID;

    SELECT EXISTS(
        SELECT 1 FROM PRODUCT WHERE SEL_ID = _Sel_ID AND Item = _Item
    ) INTO _itemExists;


    IF _customerCity <> _sellerCity THEN
        SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'Error: Seller is located in a different city. Try placing an order from the seller in your own city';
    END IF;

    IF NOT _itemExists THEN
        SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'Error: This item is not sold by seller.';
    END IF;


    SELECT DID INTO _selectedDID FROM DELIVERY_PARTNER
    WHERE City = _customerCity LIMIT 1;


    INSERT INTO ORDERS (OID, CID, Sel_ID, D_ID, Item, Status, Quantity)
    VALUES (_randomOID, _CID, _Sel_ID, _selectedDID, _Item, _Status, _Quantity);

END$$

DELIMITER ;





--Trigger 1:        

DELIMITER $$

CREATE TRIGGER PaymentImpact
AFTER INSERT ON ORDERS
FOR EACH ROW
BEGIN
    INSERT INTO PAYMENT (ONO, Txn_no, Mode) VALUES (NEW.OID, NULL, 'Cash_On_Delivery');
END$$

DELIMITER ;





--Trigger 2:     

DELIMITER $$

CREATE TRIGGER cancel_order
BEFORE DELETE ON Orders
FOR EACH ROW
BEGIN
    DECLARE payment_mode VARCHAR(255);

    IF OLD.Status = 'Delivered' THEN
        SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'Order is already delivered. Cannot cancel.';
    ELSEIF OLD.Status = 'Out_For_Delivery' THEN
        SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'Order is already out for delivery. Cannot cancel.';
    ELSE
        SELECT Mode INTO payment_mode
        FROM Payment 
        WHERE ONO = OLD.OID
        LIMIT 1;

        IF payment_mode = 'Cash_On_Delivery' THEN
            DELETE FROM Payment WHERE ONO = OLD.OID;
        ELSE
            SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'Cannot cancel as the payment is already done.';
        END IF;
    END IF;
END$$

DELIMITER ;




--Trigger 3:     

DELIMITER $$

CREATE TRIGGER remove_seller
BEFORE DELETE ON Seller
FOR EACH ROW
BEGIN
    DECLARE orders_in_process INT;

    SELECT COUNT(*) INTO orders_in_process FROM Orders 
    WHERE Sel_ID = OLD.SID AND Status NOT IN ('Delivered');

    IF orders_in_process > 0 THEN
        SIGNAL SQLSTATE '45000' 
        SET MESSAGE_TEXT = 'Seller has pending orders. Fulfill them first to de-register from the portal.';
    ELSE
             UPDATE Orders SET Sel_ID = NULL WHERE Sel_ID = OLD.SID;
    END IF;
END$$

DELIMITER ;